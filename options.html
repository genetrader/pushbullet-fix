<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title>Pushbullet Settings</title>
        <link rel="stylesheet" type="text/css" href="base.css">
        <link rel="stylesheet" type="text/css" href="big.css">
        <link rel="stylesheet" type="text/css" href="darkmode.css">
        <link rel="stylesheet" type="text/css" href="switch.css">
        <style>
            html {
                height: 100%;
            }
            body {
                height: 100%;
            }
            button {
                height: 28px;
                padding: 0;
                margin-left: 10px;
                border: 1px solid transparent;
                padding: 0 5px;
            }
            #header {
                padding: 15px;
            }
            #options {
                margin-bottom: 40px;
            }
            .inner {
                position: relative;
            }
            #account-holder {
                display: none;
                position: absolute;
                top: 0;
                right: 8px;
                background-color: white;
                border-radius: 34px;
                padding: 3px;
            }
            #account-image {
                display: block;
                height: 48px;
                width: 48px;
                border-radius: 32px;
            }
            #ribbon {
                position: absolute;
                top: 32px;
                right: 0;
                width: 24px;
                display: none;
            }
            .ribbon-small {
                display: inline-block;
                vertical-align: top;
                width: 14px;
                margin-left: 6px;
            }
            #overlay {
                position: absolute;
                top: 0;
                bottom: 0;
                left: 0;
                right: 0;
                background-color: rgba(0, 0, 0, 0.4);
            }
            #pro-dialog {
                width: 400px;
                margin: 50px auto 0 auto;
                padding: 16px;
                background: white;
                border-radius: 4px;
                box-shadow: 0 4px 12px 0 rgba(0, 0, 0, 0.25);
            }
            .dialog-option {
                font-size: 14px;
                font-weight: bold;
                text-transform: uppercase;
                float: right;
                margin-left: 16px;
                cursor: pointer;
            }
        </style>
        <script src="utils.js"></script>
        <script src="page-v3.js"></script>
        <script src="options.js"></script>
    </head>
    <body>
        <div id="header">
            <div class="inner">
                <div>
                    <a id="logo-link" href="#">
                        <div id="logo"></div>
                    </a>
                    <div style="margin-left:245px;margin-top:-10px;" id="version"></div>
                </div>
                <div id="account-holder">
                    <img id="account-image">
                </div>
                <img id="ribbon" src="ribbon.png">
            </div>
        </div>
        <div style="position:relative;height:100%;">
            <div class="inner" style="margin-bottom:100px;">
                <!-- Update notification banner -->
                <div id="update-banner" style="display:none;background-color:#4CAF50;color:white;padding:12px 15px;margin:10px 15px;border-radius:4px;position:relative;">
                    <div style="display:flex;align-items:center;justify-content:space-between;">
                        <div style="flex:1;">
                            <strong id="update-title">Update Available!</strong>
                            <span id="update-message"></span>
                        </div>
                        <div style="display:flex;gap:10px;align-items:center;">
                            <a id="update-download-link" href="#" target="_blank" style="color:white;text-decoration:underline;font-weight:bold;">Download</a>
                            <button id="update-dismiss" style="background:rgba(255,255,255,0.2);color:white;border:1px solid white;border-radius:3px;cursor:pointer;padding:4px 10px;font-size:12px;">Dismiss</button>
                        </div>
                    </div>
                </div>
                <div id="options">
                    <div id="category-general">
                        <p id="heading-general" class="section-heading"></p>
                        <div id="darkmode-option" class="option">
                            <label class="option-label">
                                <div class="switch">
                                    <input type="checkbox" id="darkmode-checkbox">
                                    <span class="slider round"></span>
                                </div>
                                <span id="darkmode-label" class="option-title"></span>
                                <img src="ribbon.png" class="ribbon-small">
                            </label>
                            <div id="darkmode-desc" class="option-desc"></div>
                        </div>
                        <div class="option chrome windows">
                            <label class="option-label" style="opacity:0.6;cursor:default;">
                                <div class="switch" style="pointer-events:none;">
                                    <input type="checkbox" id="background-permission-checkbox" checked disabled>
                                    <span class="slider round" style="opacity:0.5;"></span>
                                </div>
                                <span id="background-permission-label" class="option-title" style="color:#999;"></span>
                            </label>
                            <div id="background-permission-desc" class="option-desc" style="color:#666;font-weight:bold;font-style:italic;"></div>
                        </div>
                        <div class="option">
                            <label class="option-label">
                                <div class="switch">
                                    <input type="checkbox" id="dark-icon-checkbox">
                                    <span class="slider round"></span>
                                </div>
                                <span id="dark-icon-label" class="option-title"></span>
                            </label>
                            <div id="dark-icon-desc" class="option-desc"></div>
                        </div>
                        <div class="option">
                            <label class="option-label">
                                <div class="switch">
                                    <input type="checkbox" id="notification-count-checkbox">
                                    <span class="slider round"></span>
                                </div>
                                <span id="notification-count-label" class="option-title"></span>
                            </label>
                            <div id="notification-count-desc" class="option-desc"></div>
                        </div>
                        <div class="option">
                            <label class="option-label">
                                <div class="switch">
                                    <input type="checkbox" id="open-automatically-checkbox">
                                    <span class="slider round"></span>
                                </div>
                                <span id="open-automatically-label" class="option-title"></span>
                            </label>
                            <div id="open-automatically-desc" class="option-desc"></div>
                        </div>
                        <div class="option">
                            <label class="option-label">
                                <div class="switch">
                                    <input type="checkbox" id="auto-attach-link-checkbox">
                                    <span class="slider round"></span>
                                </div>
                                <span id="auto-attach-link-label" class="option-title"></span>
                            </label>
                            <div id="auto-attach-link-desc" class="option-desc"></div>
                        </div>
                    </div>
                    <div id="category-notifications">
                        <p id="heading-notifications" class="section-heading"></p>
                        <!-- <div class="option option-desc chrome not-opera">
                            <span id="notification-duration-label" class="option-label" style="display:inline"></span>
                            <select id="notification-duration-select" style="margin-left:6px;">
                                <option value="8">8 seconds</option>
                                <option value="0" selected>30 seconds</option>
                            </select>
                        </div> -->
                        <div class="option">
                            <label class="option-label">
                                <div class="switch">
                                    <input type="checkbox" id="show-notifications-checkbox">
                                    <span class="slider round"></span>
                                </div>
                                <span id="show-notifications-label" class="option-title"></span>
                            </label>
                            <div id="show-notifications-desc" class="option-desc"></div>
                        </div>
                        <div class="option">
                            <label class="option-label">
                                <div class="switch">
                                    <input type="checkbox" id="titles-only-checkbox">
                                    <span class="slider round"></span>
                                </div>
                                <span id="titles-only-label" class="option-title"></span>
                            </label>
                            <div id="titles-only-desc" class="option-desc"></div>
                        </div>
                        <div class="option chrome">
                            <label class="option-label">
                                <div class="switch">
                                    <input type="checkbox" id="play-sound-checkbox">
                                    <span class="slider round"></span>
                                </div>
                                <span id="play-sound-label" class="option-title"></span>
                            </label>
                            <div id="play-sound-desc" class="option-desc"></div>
                        </div>
                    </div>
                    <div id="category-advanced">
                        <p id="heading-advanced" class="section-heading"></p>
                        <div class="option">
                            <label class="option-label">
                                <div class="switch">
                                    <input type="checkbox"  id="context-menu-checkbox">
                                    <span class="slider round"></span>
                                </div>
                                <span id="context-menu-label" class="option-title"></span>
                            </label>
                            <div id="context-menu-desc" class="option-desc"></div>
                        </div>
                        <div class="option">
                            <label class="option-label">
                                <div class="switch">
                                    <input type="checkbox"  id="tabs-permission-checkbox">
                                    <span class="slider round"></span>
                                </div>
                                <span id="tabs-permission-label" class="option-title"></span>
                            </label>
                            <div id="tabs-permission-desc" class="option-desc"></div>
                        </div>
                        <div class="option">
                            <label class="option-label">
                                <div class="switch">
                                    <input type="checkbox"  id="hosts-permission-checkbox">
                                    <span class="slider round"></span>
                                </div>
                                <span id="hosts-permission-label" class="option-title"></span>
                            </label>
                            <div id="hosts-permission-desc" class="option-desc"></div>
                        </div>
                        <div class="option chrome">
                            <label class="option-label">
                                <div class="switch">
                                    <input type="checkbox" id="instant-push-checkbox">
                                    <span class="slider round"></span>
                                </div>
                                <span id="instant-push-label" class="option-title"></span>
                                <select id="instant-push-devices" style="margin-left:6px;"></select>
                            </label>
                            <div></div>
                            <span id="instant-push-desc" class="option-desc"></span>
                            <a id="keyboard-shortcut-link" class="option-desc" style="display:block;"></a>
                        </div>
                        <div class="option">
                            <label class="option-label">
                                <div class="switch">
                                    <input type="checkbox" id="e2e-checkbox">
                                    <span class="slider round"></span>
                                </div>
                                <span id="e2e-label" class="option-title"></span>
                            </label>
                            <div id="e2e-desc" class="option-desc"></div>
                            <div id="e2e-configuration" style="display:none;margin:10px 0 0 48px;">
                                <span id="e2e-password-label" class="option-label" style="display: inline;"></span>
                                <input type="password" id="e2e-password" style="display:inline-block;width:200px;border:1px solid #95a5a6;padding:4px 6px;margin-left:20px;">
                                <button id="e2e-save"></button>
                                <button id="e2e-clear" class="gray"></button>
                                <div id="e2e-password-desc" class="option-desc" style="padding-left: 0;"></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div id="category-faqs">
                    <p id="heading-faqs" class="section-heading"></p>
                    <div style="margin-left:48px;">
                        <div id="question1" class="option-label" style="padding-bottom:4px;"></div>
                        <div id="answer1"></div>
                    </div>
                </div>
                <div id="category-changelog" style="margin-top:24px;padding:15px;background-color:#e8f5e9;border-radius:4px;border:1px solid #4CAF50;">
                    <p style="font-weight:bold;font-size:16px;margin-bottom:12px;color:#2E7D32;">ðŸ“‹ Release Notes</p>

                    <div style="max-height:200px;overflow-y:auto;padding-right:10px;">
                        <div style="margin-bottom:16px;">
                            <p style="font-weight:bold;font-size:14px;color:#1B5E20;margin-bottom:8px;">Version 379 - December 2025</p>
                            <ul style="margin:0;padding-left:20px;line-height:1.8;">
                                <li><strong>Fixed:</strong> Settings not persisting after browser restart (dark mode, auto-open, etc.)</li>
                                <li><strong>Fixed:</strong> Background permission toggle error</li>
                                <li><strong>Fixed:</strong> Notification sounds now working in Manifest V3 (Offscreen Documents API)</li>
                                <li><strong>Fixed:</strong> Chat windows and SMS not loading (page-v3.js compatibility)</li>
                                <li><strong>Improved:</strong> Background notifications via Chrome Alarms API (1-minute delay when browser closed)</li>
                                <li><strong>Improved:</strong> SMS notification handling with 90-second fetch window</li>
                                <li><strong>Added:</strong> GitHub update checker - alerts when new version available</li>
                                <li><strong>Added:</strong> Support & Feedback section with links to report issues</li>
                            </ul>
                        </div>

                        <div style="margin-bottom:16px;">
                            <p style="font-weight:bold;font-size:14px;color:#1B5E20;margin-bottom:8px;">Version 378</p>
                            <ul style="margin:0;padding-left:20px;line-height:1.8;">
                                <li>Add prominent MMS + encryption incompatibility warnings</li>
                                <li>Fix thread disappearing during MMS send</li>
                            </ul>
                        </div>

                        <div>
                            <p style="font-weight:bold;font-size:14px;color:#1B5E20;margin-bottom:8px;">Version 377</p>
                            <ul style="margin:0;padding-left:20px;line-height:1.8;">
                                <li>Fix greyed out MMS preview</li>
                                <li>Handle 404 errors gracefully</li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div id="category-support" style="margin-top:24px;padding:15px;background-color:#f5f5f5;border-radius:4px;">
                    <p style="font-weight:bold;font-size:14px;margin-bottom:12px;">Support & Feedback</p>
                    <table style="width:100%;border-spacing:0;">
                        <tr>
                            <td style="width:25%;padding:8px;text-align:center;vertical-align:top;">
                                <a href="https://github.com/genetrader/pushbullet-fix/issues" target="_blank" style="color:#4CAF50;text-decoration:none;font-weight:500;display:inline-flex;align-items:center;gap:5px;white-space:nowrap;">
                                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                        <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/>
                                    </svg>
                                    Report an Issue
                                </a>
                                <div style="font-size:11px;color:#888;margin-top:4px;">Found a bug?</div>
                            </td>
                            <td style="width:25%;padding:8px;text-align:center;vertical-align:top;">
                                <a href="https://github.com/genetrader/pushbullet-fix" target="_blank" style="color:#4CAF50;text-decoration:none;font-weight:500;display:inline-flex;align-items:center;gap:5px;white-space:nowrap;">
                                    <svg width="16" height="16" viewBox="0 0 16 16" fill="currentColor">
                                        <path d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/>
                                    </svg>
                                    View on GitHub
                                </a>
                                <div style="font-size:11px;color:#888;margin-top:4px;">Check out the code</div>
                            </td>
                            <td style="width:25%;padding:8px;text-align:center;vertical-align:top;">
                                <a id="support-link" href="#" target="_blank" style="color:#FF9800;text-decoration:none;font-weight:500;display:inline-flex;align-items:center;gap:5px;white-space:nowrap;">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1.41 16.09V20h-2.67v-1.93c-1.71-.36-3.16-1.46-3.27-3.4h1.96c.1 1.05.82 1.87 2.65 1.87 1.96 0 2.4-.98 2.4-1.59 0-.83-.44-1.61-2.67-2.14-2.48-.6-4.18-1.62-4.18-3.67 0-1.72 1.39-2.84 3.11-3.21V4h2.67v1.95c1.86.45 2.79 1.86 2.85 3.39H14.3c-.05-1.11-.64-1.87-2.22-1.87-1.5 0-2.4.68-2.4 1.64 0 .84.65 1.39 2.67 1.91s4.18 1.39 4.18 3.91c-.01 1.83-1.38 2.83-3.12 3.16z"/>
                                    </svg>
                                    Show Gene Love
                                </a>
                                <div style="font-size:11px;color:#888;margin-top:4px;font-style:italic;">Appreciated but not obligated!</div>
                            </td>
                            <td style="width:25%;padding:8px;text-align:center;vertical-align:top;">
                                <a href="mailto:genetrader@gmail.com?subject=GENE - CODING REQUEST - " target="_blank" style="color:#2196F3;text-decoration:none;font-weight:500;display:inline-flex;align-items:center;gap:5px;white-space:nowrap;">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
                                        <path d="M20 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 4l-8 5-8-5V6l8 5 8-5v2z"/>
                                    </svg>
                                    Have Gene Code Something
                                </a>
                                <div style="font-size:11px;color:#888;margin-top:4px;font-style:italic;">Partner With Gene...</div>
                            </td>
                        </tr>
                    </table>
                </div>
            </div>
            <div id="overlay" style="display:none;">
                <div id="pro-dialog">
                    <div>
                        <img src="ribbon.png" width="32" style="display:inline-block;vertical-align:middle;">
                        <span id="pro-required" style="font-weight:bold;font-size:18px;margin-left:12px;"></span>
                    </div>
                    <div id="pro-required-desc" style="margin:16px 0;">
                    </div>
                    <div style="overflow:hidden;margin-top:4px;">
                        <span id="pro-dialog-more" class="dialog-option" style="color:#38a06d"></span>
                        <span id="pro-dialog-cancel" class="dialog-option"></span>
                    </div>
                </div>
            </div>
        </div>
    </body>
</html>
